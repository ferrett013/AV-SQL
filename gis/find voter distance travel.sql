drop table if exists research.voter_distance;
create table research.voter_distance as 
select *
,ST_Distance_Spheroid(voter_geom, loc_geom,'SPHEROID["WGS 84",6378137,298.257223563]') as dist
from (
	select voter_id
	,c.party
	,countyname
	,race
	,vzip5
	,loc_id
	,loc_lat
	,loc_long
	,loc_geom
	,voter_lat
	,voter_long
	,voter_geom
	from early_voters.ce19_2016 a
	join (
		select id as loc_id
		,latitude as loc_lat
		,longitude as loc_long
		,st_setsrid(geom, 4326) as loc_geom
		from voting_locations.vspc_general2016
	) b using (loc_id)
	join (
			select distinct statefileid as voter_id
			,latitude as voter_lat
			,longitude as voter_long
			,st_setsrid(st_makepoint(longitude,latitude),4326) as voter_geom
			,party
			,countyname
			,race
			,vzip5
			from voterfiles_van.december2016
			where latitude is not null and longitude is not null
	) c using (voter_id)
	where voter_lat > 37 and voter_lat < 41 and voter_long > -109.05 and voter_long < -102.05
) a;

select * from research.voter_distance;
drop table if exists research.zip_urban_rural;
create table research.zip_urban_rural (zip5 text, classification text);
insert into research.zip_urban_rural values ('80002', 'Urban');
insert into research.zip_urban_rural values ('80003', 'Urban');
insert into research.zip_urban_rural values ('80004', 'Urban');
insert into research.zip_urban_rural values ('80005', 'Urban');
insert into research.zip_urban_rural values ('80007', 'Urban');
insert into research.zip_urban_rural values ('80010', 'Urban');
insert into research.zip_urban_rural values ('80011', 'Urban');
insert into research.zip_urban_rural values ('80012', 'Urban');
insert into research.zip_urban_rural values ('80013', 'Urban');
insert into research.zip_urban_rural values ('80014', 'Urban');
insert into research.zip_urban_rural values ('80015', 'Urban');
insert into research.zip_urban_rural values ('80016', 'Urban');
insert into research.zip_urban_rural values ('80017', 'Urban');
insert into research.zip_urban_rural values ('80018', 'Urban');
insert into research.zip_urban_rural values ('80019', 'Urban');
insert into research.zip_urban_rural values ('80020', 'Urban');
insert into research.zip_urban_rural values ('80021', 'Urban');
insert into research.zip_urban_rural values ('80022', 'Urban');
insert into research.zip_urban_rural values ('80023', 'Urban');
insert into research.zip_urban_rural values ('80024', 'Urban');
insert into research.zip_urban_rural values ('80025', 'Rural');
insert into research.zip_urban_rural values ('80026', 'Urban');
insert into research.zip_urban_rural values ('80027', 'Urban');
insert into research.zip_urban_rural values ('80030', 'Urban');
insert into research.zip_urban_rural values ('80031', 'Urban');
insert into research.zip_urban_rural values ('80033', 'Urban');
insert into research.zip_urban_rural values ('80045', 'Urban');
insert into research.zip_urban_rural values ('80101', 'Rural');
insert into research.zip_urban_rural values ('80102', 'Rural');
insert into research.zip_urban_rural values ('80103', 'Rural');
insert into research.zip_urban_rural values ('80104', 'Urban');
insert into research.zip_urban_rural values ('80105', 'Rural');
insert into research.zip_urban_rural values ('80106', 'Rural');
insert into research.zip_urban_rural values ('80107', 'Rural');
insert into research.zip_urban_rural values ('80108', 'Urban');
insert into research.zip_urban_rural values ('80109', 'Urban');
insert into research.zip_urban_rural values ('80110', 'Urban');
insert into research.zip_urban_rural values ('80111', 'Urban');
insert into research.zip_urban_rural values ('80112', 'Urban');
insert into research.zip_urban_rural values ('80113', 'Urban');
insert into research.zip_urban_rural values ('80116', 'Rural');
insert into research.zip_urban_rural values ('80117', 'Rural');
insert into research.zip_urban_rural values ('80118', 'Rural');
insert into research.zip_urban_rural values ('80120', 'Urban');
insert into research.zip_urban_rural values ('80121', 'Urban');
insert into research.zip_urban_rural values ('80122', 'Urban');
insert into research.zip_urban_rural values ('80123', 'Urban');
insert into research.zip_urban_rural values ('80124', 'Urban');
insert into research.zip_urban_rural values ('80125', 'Urban');
insert into research.zip_urban_rural values ('80126', 'Urban');
insert into research.zip_urban_rural values ('80127', 'Urban');
insert into research.zip_urban_rural values ('80128', 'Urban');
insert into research.zip_urban_rural values ('80129', 'Urban');
insert into research.zip_urban_rural values ('80130', 'Urban');
insert into research.zip_urban_rural values ('80131', 'Rural');
insert into research.zip_urban_rural values ('80132', 'Urban');
insert into research.zip_urban_rural values ('80133', 'Urban');
insert into research.zip_urban_rural values ('80134', 'Urban');
insert into research.zip_urban_rural values ('80135', 'Rural');
insert into research.zip_urban_rural values ('80136', 'Rural');
insert into research.zip_urban_rural values ('80137', 'Rural');
insert into research.zip_urban_rural values ('80138', 'Urban');
insert into research.zip_urban_rural values ('80202', 'Urban');
insert into research.zip_urban_rural values ('80203', 'Urban');
insert into research.zip_urban_rural values ('80204', 'Urban');
insert into research.zip_urban_rural values ('80205', 'Urban');
insert into research.zip_urban_rural values ('80206', 'Urban');
insert into research.zip_urban_rural values ('80207', 'Urban');
insert into research.zip_urban_rural values ('80209', 'Urban');
insert into research.zip_urban_rural values ('80210', 'Urban');
insert into research.zip_urban_rural values ('80211', 'Urban');
insert into research.zip_urban_rural values ('80212', 'Urban');
insert into research.zip_urban_rural values ('80214', 'Urban');
insert into research.zip_urban_rural values ('80215', 'Urban');
insert into research.zip_urban_rural values ('80216', 'Urban');
insert into research.zip_urban_rural values ('80218', 'Urban');
insert into research.zip_urban_rural values ('80219', 'Urban');
insert into research.zip_urban_rural values ('80220', 'Urban');
insert into research.zip_urban_rural values ('80221', 'Urban');
insert into research.zip_urban_rural values ('80222', 'Urban');
insert into research.zip_urban_rural values ('80223', 'Urban');
insert into research.zip_urban_rural values ('80224', 'Urban');
insert into research.zip_urban_rural values ('80226', 'Urban');
insert into research.zip_urban_rural values ('80227', 'Urban');
insert into research.zip_urban_rural values ('80228', 'Urban');
insert into research.zip_urban_rural values ('80229', 'Urban');
insert into research.zip_urban_rural values ('80230', 'Urban');
insert into research.zip_urban_rural values ('80231', 'Urban');
insert into research.zip_urban_rural values ('80232', 'Urban');
insert into research.zip_urban_rural values ('80233', 'Urban');
insert into research.zip_urban_rural values ('80234', 'Urban');
insert into research.zip_urban_rural values ('80235', 'Urban');
insert into research.zip_urban_rural values ('80236', 'Urban');
insert into research.zip_urban_rural values ('80237', 'Urban');
insert into research.zip_urban_rural values ('80238', 'Urban');
insert into research.zip_urban_rural values ('80239', 'Urban');
insert into research.zip_urban_rural values ('80241', 'Urban');
insert into research.zip_urban_rural values ('80246', 'Urban');
insert into research.zip_urban_rural values ('80247', 'Urban');
insert into research.zip_urban_rural values ('80249', 'Urban');
insert into research.zip_urban_rural values ('80260', 'Urban');
insert into research.zip_urban_rural values ('80264', 'Rural');
insert into research.zip_urban_rural values ('80290', 'Rural');
insert into research.zip_urban_rural values ('80293', 'Rural');
insert into research.zip_urban_rural values ('80294', 'Rural');
insert into research.zip_urban_rural values ('80301', 'Urban');
insert into research.zip_urban_rural values ('80302', 'Urban');
insert into research.zip_urban_rural values ('80303', 'Urban');
insert into research.zip_urban_rural values ('80304', 'Urban');
insert into research.zip_urban_rural values ('80305', 'Urban');
insert into research.zip_urban_rural values ('80310', 'Urban');
insert into research.zip_urban_rural values ('80401', 'Urban');
insert into research.zip_urban_rural values ('80403', 'Urban');
insert into research.zip_urban_rural values ('80419', 'Rural');
insert into research.zip_urban_rural values ('80420', 'Rural');
insert into research.zip_urban_rural values ('80421', 'Rural');
insert into research.zip_urban_rural values ('80422', 'Rural');
insert into research.zip_urban_rural values ('80423', 'Rural');
insert into research.zip_urban_rural values ('80424', 'Urban');
insert into research.zip_urban_rural values ('80425', 'Rural');
insert into research.zip_urban_rural values ('80426', 'Rural');
insert into research.zip_urban_rural values ('80427', 'Rural');
insert into research.zip_urban_rural values ('80428', 'Rural');
insert into research.zip_urban_rural values ('80432', 'Rural');
insert into research.zip_urban_rural values ('80433', 'Rural');
insert into research.zip_urban_rural values ('80434', 'Rural');
insert into research.zip_urban_rural values ('80435', 'Urban');
insert into research.zip_urban_rural values ('80436', 'Rural');
insert into research.zip_urban_rural values ('80438', 'Rural');
insert into research.zip_urban_rural values ('80439', 'Rural');
insert into research.zip_urban_rural values ('80440', 'Rural');
insert into research.zip_urban_rural values ('80442', 'Urban');
insert into research.zip_urban_rural values ('80443', 'Urban');
insert into research.zip_urban_rural values ('80444', 'Rural');
insert into research.zip_urban_rural values ('80446', 'Rural');
insert into research.zip_urban_rural values ('80447', 'Rural');
insert into research.zip_urban_rural values ('80448', 'Rural');
insert into research.zip_urban_rural values ('80449', 'Rural');
insert into research.zip_urban_rural values ('80451', 'Rural');
insert into research.zip_urban_rural values ('80452', 'Rural');
insert into research.zip_urban_rural values ('80453', 'Rural');
insert into research.zip_urban_rural values ('80454', 'Rural');
insert into research.zip_urban_rural values ('80455', 'Rural');
insert into research.zip_urban_rural values ('80456', 'Rural');
insert into research.zip_urban_rural values ('80457', 'Urban');
insert into research.zip_urban_rural values ('80459', 'Rural');
insert into research.zip_urban_rural values ('80461', 'Urban');
insert into research.zip_urban_rural values ('80463', 'Rural');
insert into research.zip_urban_rural values ('80465', 'Urban');
insert into research.zip_urban_rural values ('80466', 'Rural');
insert into research.zip_urban_rural values ('80467', 'Rural');
insert into research.zip_urban_rural values ('80468', 'Rural');
insert into research.zip_urban_rural values ('80469', 'Rural');
insert into research.zip_urban_rural values ('80470', 'Rural');
insert into research.zip_urban_rural values ('80471', 'Rural');
insert into research.zip_urban_rural values ('80473', 'Rural');
insert into research.zip_urban_rural values ('80475', 'Rural');
insert into research.zip_urban_rural values ('80476', 'Rural');
insert into research.zip_urban_rural values ('80477', 'Urban');
insert into research.zip_urban_rural values ('80478', 'Rural');
insert into research.zip_urban_rural values ('80479', 'Rural');
insert into research.zip_urban_rural values ('80480', 'Rural');
insert into research.zip_urban_rural values ('80481', 'Rural');
insert into research.zip_urban_rural values ('80482', 'Urban');
insert into research.zip_urban_rural values ('80483', 'Rural');
insert into research.zip_urban_rural values ('80487', 'Urban');
insert into research.zip_urban_rural values ('80488', 'Urban');
insert into research.zip_urban_rural values ('80497', 'Urban');
insert into research.zip_urban_rural values ('80498', 'Urban');
insert into research.zip_urban_rural values ('80501', 'Urban');
insert into research.zip_urban_rural values ('80503', 'Urban');
insert into research.zip_urban_rural values ('80504', 'Urban');
insert into research.zip_urban_rural values ('80510', 'Rural');
insert into research.zip_urban_rural values ('80511', 'Urban');
insert into research.zip_urban_rural values ('80512', 'Rural');
insert into research.zip_urban_rural values ('80513', 'Rural');
insert into research.zip_urban_rural values ('80514', 'Urban');
insert into research.zip_urban_rural values ('80515', 'Rural');
insert into research.zip_urban_rural values ('80516', 'Urban');
insert into research.zip_urban_rural values ('80517', 'Urban');
insert into research.zip_urban_rural values ('80520', 'Urban');
insert into research.zip_urban_rural values ('80521', 'Urban');
insert into research.zip_urban_rural values ('80524', 'Urban');
insert into research.zip_urban_rural values ('80525', 'Urban');
insert into research.zip_urban_rural values ('80526', 'Urban');
insert into research.zip_urban_rural values ('80528', 'Urban');
insert into research.zip_urban_rural values ('80530', 'Urban');
insert into research.zip_urban_rural values ('80532', 'Rural');
insert into research.zip_urban_rural values ('80534', 'Urban');
insert into research.zip_urban_rural values ('80535', 'Urban');
insert into research.zip_urban_rural values ('80536', 'Rural');
insert into research.zip_urban_rural values ('80537', 'Urban');
insert into research.zip_urban_rural values ('80538', 'Urban');
insert into research.zip_urban_rural values ('80540', 'Rural');
insert into research.zip_urban_rural values ('80542', 'Rural');
insert into research.zip_urban_rural values ('80543', 'Urban');
insert into research.zip_urban_rural values ('80544', 'Urban');
insert into research.zip_urban_rural values ('80545', 'Rural');
insert into research.zip_urban_rural values ('80546', 'Urban');
insert into research.zip_urban_rural values ('80547', 'Rural');
insert into research.zip_urban_rural values ('80549', 'Urban');
insert into research.zip_urban_rural values ('80550', 'Urban');
insert into research.zip_urban_rural values ('80601', 'Urban');
insert into research.zip_urban_rural values ('80602', 'Urban');
insert into research.zip_urban_rural values ('80603', 'Urban');
insert into research.zip_urban_rural values ('80610', 'Rural');
insert into research.zip_urban_rural values ('80611', 'Rural');
insert into research.zip_urban_rural values ('80612', 'Rural');
insert into research.zip_urban_rural values ('80615', 'Urban');
insert into research.zip_urban_rural values ('80620', 'Urban');
insert into research.zip_urban_rural values ('80621', 'Urban');
insert into research.zip_urban_rural values ('80622', 'Rural');
insert into research.zip_urban_rural values ('80623', 'Rural');
insert into research.zip_urban_rural values ('80624', 'Rural');
insert into research.zip_urban_rural values ('80631', 'Urban');
insert into research.zip_urban_rural values ('80634', 'Urban');
insert into research.zip_urban_rural values ('80640', 'Urban');
insert into research.zip_urban_rural values ('80642', 'Rural');
insert into research.zip_urban_rural values ('80643', 'Rural');
insert into research.zip_urban_rural values ('80644', 'Rural');
insert into research.zip_urban_rural values ('80645', 'Rural');
insert into research.zip_urban_rural values ('80648', 'Rural');
insert into research.zip_urban_rural values ('80649', 'Rural');
insert into research.zip_urban_rural values ('80650', 'Rural');
insert into research.zip_urban_rural values ('80651', 'Rural');
insert into research.zip_urban_rural values ('80652', 'Rural');
insert into research.zip_urban_rural values ('80653', 'Rural');
insert into research.zip_urban_rural values ('80654', 'Rural');
insert into research.zip_urban_rural values ('80701', 'Urban');
insert into research.zip_urban_rural values ('80705', 'Urban');
insert into research.zip_urban_rural values ('80720', 'Rural');
insert into research.zip_urban_rural values ('80721', 'Rural');
insert into research.zip_urban_rural values ('80722', 'Rural');
insert into research.zip_urban_rural values ('80723', 'Urban');
insert into research.zip_urban_rural values ('80726', 'Rural');
insert into research.zip_urban_rural values ('80727', 'Rural');
insert into research.zip_urban_rural values ('80728', 'Rural');
insert into research.zip_urban_rural values ('80729', 'Rural');
insert into research.zip_urban_rural values ('80731', 'Rural');
insert into research.zip_urban_rural values ('80733', 'Rural');
insert into research.zip_urban_rural values ('80734', 'Rural');
insert into research.zip_urban_rural values ('80735', 'Rural');
insert into research.zip_urban_rural values ('80736', 'Rural');
insert into research.zip_urban_rural values ('80737', 'Rural');
insert into research.zip_urban_rural values ('80740', 'Rural');
insert into research.zip_urban_rural values ('80741', 'Rural');
insert into research.zip_urban_rural values ('80742', 'Rural');
insert into research.zip_urban_rural values ('80743', 'Rural');
insert into research.zip_urban_rural values ('80744', 'Rural');
insert into research.zip_urban_rural values ('80745', 'Rural');
insert into research.zip_urban_rural values ('80746', 'Rural');
insert into research.zip_urban_rural values ('80747', 'Rural');
insert into research.zip_urban_rural values ('80749', 'Rural');
insert into research.zip_urban_rural values ('80750', 'Rural');
insert into research.zip_urban_rural values ('80751', 'Urban');
insert into research.zip_urban_rural values ('80754', 'Rural');
insert into research.zip_urban_rural values ('80755', 'Rural');
insert into research.zip_urban_rural values ('80757', 'Rural');
insert into research.zip_urban_rural values ('80758', 'Rural');
insert into research.zip_urban_rural values ('80759', 'Urban');
insert into research.zip_urban_rural values ('80801', 'Rural');
insert into research.zip_urban_rural values ('80802', 'Rural');
insert into research.zip_urban_rural values ('80804', 'Rural');
insert into research.zip_urban_rural values ('80805', 'Rural');
insert into research.zip_urban_rural values ('80807', 'Urban');
insert into research.zip_urban_rural values ('80808', 'Rural');
insert into research.zip_urban_rural values ('80809', 'Urban');
insert into research.zip_urban_rural values ('80810', 'Rural');
insert into research.zip_urban_rural values ('80812', 'Rural');
insert into research.zip_urban_rural values ('80813', 'Rural');
insert into research.zip_urban_rural values ('80814', 'Rural');
insert into research.zip_urban_rural values ('80815', 'Rural');
insert into research.zip_urban_rural values ('80816', 'Rural');
insert into research.zip_urban_rural values ('80817', 'Urban');
insert into research.zip_urban_rural values ('80818', 'Rural');
insert into research.zip_urban_rural values ('80819', 'Urban');
insert into research.zip_urban_rural values ('80820', 'Rural');
insert into research.zip_urban_rural values ('80821', 'Rural');
insert into research.zip_urban_rural values ('80822', 'Rural');
insert into research.zip_urban_rural values ('80823', 'Rural');
insert into research.zip_urban_rural values ('80824', 'Rural');
insert into research.zip_urban_rural values ('80825', 'Rural');
insert into research.zip_urban_rural values ('80827', 'Rural');
insert into research.zip_urban_rural values ('80828', 'Rural');
insert into research.zip_urban_rural values ('80829', 'Urban');
insert into research.zip_urban_rural values ('80830', 'Rural');
insert into research.zip_urban_rural values ('80831', 'Rural');
insert into research.zip_urban_rural values ('80832', 'Rural');
insert into research.zip_urban_rural values ('80833', 'Rural');
insert into research.zip_urban_rural values ('80834', 'Rural');
insert into research.zip_urban_rural values ('80835', 'Rural');
insert into research.zip_urban_rural values ('80836', 'Rural');
insert into research.zip_urban_rural values ('80840', 'Rural');
insert into research.zip_urban_rural values ('80860', 'Rural');
insert into research.zip_urban_rural values ('80861', 'Rural');
insert into research.zip_urban_rural values ('80862', 'Rural');
insert into research.zip_urban_rural values ('80863', 'Urban');
insert into research.zip_urban_rural values ('80864', 'Rural');
insert into research.zip_urban_rural values ('80902', 'Urban');
insert into research.zip_urban_rural values ('80903', 'Urban');
insert into research.zip_urban_rural values ('80904', 'Urban');
insert into research.zip_urban_rural values ('80905', 'Urban');
insert into research.zip_urban_rural values ('80906', 'Urban');
insert into research.zip_urban_rural values ('80907', 'Urban');
insert into research.zip_urban_rural values ('80908', 'Rural');
insert into research.zip_urban_rural values ('80909', 'Urban');
insert into research.zip_urban_rural values ('80910', 'Urban');
insert into research.zip_urban_rural values ('80911', 'Urban');
insert into research.zip_urban_rural values ('80913', 'Rural');
insert into research.zip_urban_rural values ('80914', 'Rural');
insert into research.zip_urban_rural values ('80915', 'Urban');
insert into research.zip_urban_rural values ('80916', 'Urban');
insert into research.zip_urban_rural values ('80917', 'Urban');
insert into research.zip_urban_rural values ('80918', 'Urban');
insert into research.zip_urban_rural values ('80919', 'Urban');
insert into research.zip_urban_rural values ('80920', 'Urban');
insert into research.zip_urban_rural values ('80921', 'Urban');
insert into research.zip_urban_rural values ('80922', 'Urban');
insert into research.zip_urban_rural values ('80923', 'Urban');
insert into research.zip_urban_rural values ('80924', 'Urban');
insert into research.zip_urban_rural values ('80925', 'Rural');
insert into research.zip_urban_rural values ('80926', 'Rural');
insert into research.zip_urban_rural values ('80927', 'Urban');
insert into research.zip_urban_rural values ('80928', 'Rural');
insert into research.zip_urban_rural values ('80929', 'Rural');
insert into research.zip_urban_rural values ('80930', 'Rural');
insert into research.zip_urban_rural values ('80938', 'Rural');
insert into research.zip_urban_rural values ('80939', 'Rural');
insert into research.zip_urban_rural values ('80951', 'Urban');
insert into research.zip_urban_rural values ('81001', 'Urban');
insert into research.zip_urban_rural values ('81003', 'Urban');
insert into research.zip_urban_rural values ('81004', 'Urban');
insert into research.zip_urban_rural values ('81005', 'Urban');
insert into research.zip_urban_rural values ('81006', 'Urban');
insert into research.zip_urban_rural values ('81007', 'Urban');
insert into research.zip_urban_rural values ('81008', 'Urban');
insert into research.zip_urban_rural values ('81019', 'Rural');
insert into research.zip_urban_rural values ('81020', 'Rural');
insert into research.zip_urban_rural values ('81021', 'Rural');
insert into research.zip_urban_rural values ('81022', 'Rural');
insert into research.zip_urban_rural values ('81023', 'Rural');
insert into research.zip_urban_rural values ('81024', 'Rural');
insert into research.zip_urban_rural values ('81025', 'Rural');
insert into research.zip_urban_rural values ('81027', 'Rural');
insert into research.zip_urban_rural values ('81029', 'Rural');
insert into research.zip_urban_rural values ('81030', 'Rural');
insert into research.zip_urban_rural values ('81033', 'Rural');
insert into research.zip_urban_rural values ('81036', 'Rural');
insert into research.zip_urban_rural values ('81038', 'Rural');
insert into research.zip_urban_rural values ('81039', 'Rural');
insert into research.zip_urban_rural values ('81040', 'Rural');
insert into research.zip_urban_rural values ('81041', 'Rural');
insert into research.zip_urban_rural values ('81043', 'Rural');
insert into research.zip_urban_rural values ('81044', 'Rural');
insert into research.zip_urban_rural values ('81045', 'Rural');
insert into research.zip_urban_rural values ('81047', 'Rural');
insert into research.zip_urban_rural values ('81049', 'Rural');
insert into research.zip_urban_rural values ('81050', 'Urban');
insert into research.zip_urban_rural values ('81052', 'Urban');
insert into research.zip_urban_rural values ('81054', 'Urban');
insert into research.zip_urban_rural values ('81055', 'Rural');
insert into research.zip_urban_rural values ('81057', 'Rural');
insert into research.zip_urban_rural values ('81058', 'Rural');
insert into research.zip_urban_rural values ('81059', 'Rural');
insert into research.zip_urban_rural values ('81062', 'Rural');
insert into research.zip_urban_rural values ('81063', 'Rural');
insert into research.zip_urban_rural values ('81064', 'Rural');
insert into research.zip_urban_rural values ('81067', 'Urban');
insert into research.zip_urban_rural values ('81069', 'Rural');
insert into research.zip_urban_rural values ('81071', 'Rural');
insert into research.zip_urban_rural values ('81073', 'Rural');
insert into research.zip_urban_rural values ('81076', 'Rural');
insert into research.zip_urban_rural values ('81077', 'Urban');
insert into research.zip_urban_rural values ('81081', 'Rural');
insert into research.zip_urban_rural values ('81082', 'Urban');
insert into research.zip_urban_rural values ('81084', 'Rural');
insert into research.zip_urban_rural values ('81087', 'Rural');
insert into research.zip_urban_rural values ('81089', 'Urban');
insert into research.zip_urban_rural values ('81090', 'Rural');
insert into research.zip_urban_rural values ('81091', 'Rural');
insert into research.zip_urban_rural values ('81092', 'Rural');
insert into research.zip_urban_rural values ('81101', 'Urban');
insert into research.zip_urban_rural values ('81120', 'Rural');
insert into research.zip_urban_rural values ('81121', 'Rural');
insert into research.zip_urban_rural values ('81122', 'Rural');
insert into research.zip_urban_rural values ('81123', 'Rural');
insert into research.zip_urban_rural values ('81124', 'Rural');
insert into research.zip_urban_rural values ('81125', 'Rural');
insert into research.zip_urban_rural values ('81126', 'Rural');
insert into research.zip_urban_rural values ('81128', 'Rural');
insert into research.zip_urban_rural values ('81129', 'Rural');
insert into research.zip_urban_rural values ('81130', 'Rural');
insert into research.zip_urban_rural values ('81131', 'Rural');
insert into research.zip_urban_rural values ('81132', 'Rural');
insert into research.zip_urban_rural values ('81133', 'Rural');
insert into research.zip_urban_rural values ('81136', 'Rural');
insert into research.zip_urban_rural values ('81137', 'Rural');
insert into research.zip_urban_rural values ('81138', 'Rural');
insert into research.zip_urban_rural values ('81140', 'Rural');
insert into research.zip_urban_rural values ('81141', 'Rural');
insert into research.zip_urban_rural values ('81143', 'Rural');
insert into research.zip_urban_rural values ('81144', 'Urban');
insert into research.zip_urban_rural values ('81146', 'Rural');
insert into research.zip_urban_rural values ('81147', 'Rural');
insert into research.zip_urban_rural values ('81148', 'Rural');
insert into research.zip_urban_rural values ('81149', 'Rural');
insert into research.zip_urban_rural values ('81151', 'Rural');
insert into research.zip_urban_rural values ('81152', 'Rural');
insert into research.zip_urban_rural values ('81154', 'Rural');
insert into research.zip_urban_rural values ('81155', 'Rural');
insert into research.zip_urban_rural values ('81201', 'Urban');
insert into research.zip_urban_rural values ('81210', 'Rural');
insert into research.zip_urban_rural values ('81211', 'Rural');
insert into research.zip_urban_rural values ('81212', 'Urban');
insert into research.zip_urban_rural values ('81220', 'Rural');
insert into research.zip_urban_rural values ('81221', 'Rural');
insert into research.zip_urban_rural values ('81222', 'Rural');
insert into research.zip_urban_rural values ('81223', 'Rural');
insert into research.zip_urban_rural values ('81224', 'Rural');
insert into research.zip_urban_rural values ('81225', 'Rural');
insert into research.zip_urban_rural values ('81226', 'Urban');
insert into research.zip_urban_rural values ('81227', 'Rural');
insert into research.zip_urban_rural values ('81230', 'Urban');
insert into research.zip_urban_rural values ('81231', 'Urban');
insert into research.zip_urban_rural values ('81232', 'Rural');
insert into research.zip_urban_rural values ('81233', 'Rural');
insert into research.zip_urban_rural values ('81235', 'Rural');
insert into research.zip_urban_rural values ('81236', 'Rural');
insert into research.zip_urban_rural values ('81237', 'Rural');
insert into research.zip_urban_rural values ('81239', 'Rural');
insert into research.zip_urban_rural values ('81240', 'Rural');
insert into research.zip_urban_rural values ('81241', 'Rural');
insert into research.zip_urban_rural values ('81242', 'Urban');
insert into research.zip_urban_rural values ('81243', 'Rural');
insert into research.zip_urban_rural values ('81244', 'Rural');
insert into research.zip_urban_rural values ('81248', 'Rural');
insert into research.zip_urban_rural values ('81251', 'Rural');
insert into research.zip_urban_rural values ('81252', 'Rural');
insert into research.zip_urban_rural values ('81253', 'Rural');
insert into research.zip_urban_rural values ('81301', 'Urban');
insert into research.zip_urban_rural values ('81303', 'Rural');
insert into research.zip_urban_rural values ('81320', 'Rural');
insert into research.zip_urban_rural values ('81321', 'Urban');
insert into research.zip_urban_rural values ('81323', 'Rural');
insert into research.zip_urban_rural values ('81324', 'Rural');
insert into research.zip_urban_rural values ('81325', 'Rural');
insert into research.zip_urban_rural values ('81326', 'Rural');
insert into research.zip_urban_rural values ('81327', 'Rural');
insert into research.zip_urban_rural values ('81328', 'Rural');
insert into research.zip_urban_rural values ('81330', 'Rural');
insert into research.zip_urban_rural values ('81331', 'Rural');
insert into research.zip_urban_rural values ('81332', 'Rural');
insert into research.zip_urban_rural values ('81334', 'Rural');
insert into research.zip_urban_rural values ('81335', 'Rural');
insert into research.zip_urban_rural values ('81401', 'Urban');
insert into research.zip_urban_rural values ('81403', 'Rural');
insert into research.zip_urban_rural values ('81410', 'Rural');
insert into research.zip_urban_rural values ('81411', 'Rural');
insert into research.zip_urban_rural values ('81413', 'Rural');
insert into research.zip_urban_rural values ('81415', 'Rural');
insert into research.zip_urban_rural values ('81416', 'Urban');
insert into research.zip_urban_rural values ('81418', 'Urban');
insert into research.zip_urban_rural values ('81419', 'Rural');
insert into research.zip_urban_rural values ('81422', 'Rural');
insert into research.zip_urban_rural values ('81423', 'Rural');
insert into research.zip_urban_rural values ('81424', 'Rural');
insert into research.zip_urban_rural values ('81425', 'Rural');
insert into research.zip_urban_rural values ('81426', 'Rural');
insert into research.zip_urban_rural values ('81427', 'Rural');
insert into research.zip_urban_rural values ('81428', 'Rural');
insert into research.zip_urban_rural values ('81429', 'Rural');
insert into research.zip_urban_rural values ('81430', 'Rural');
insert into research.zip_urban_rural values ('81431', 'Rural');
insert into research.zip_urban_rural values ('81432', 'Rural');
insert into research.zip_urban_rural values ('81433', 'Rural');
insert into research.zip_urban_rural values ('81434', 'Rural');
insert into research.zip_urban_rural values ('81435', 'Rural');
insert into research.zip_urban_rural values ('81501', 'Urban');
insert into research.zip_urban_rural values ('81503', 'Urban');
insert into research.zip_urban_rural values ('81504', 'Urban');
insert into research.zip_urban_rural values ('81505', 'Urban');
insert into research.zip_urban_rural values ('81506', 'Urban');
insert into research.zip_urban_rural values ('81507', 'Urban');
insert into research.zip_urban_rural values ('81520', 'Urban');
insert into research.zip_urban_rural values ('81521', 'Urban');
insert into research.zip_urban_rural values ('81522', 'Rural');
insert into research.zip_urban_rural values ('81523', 'Rural');
insert into research.zip_urban_rural values ('81524', 'Rural');
insert into research.zip_urban_rural values ('81525', 'Rural');
insert into research.zip_urban_rural values ('81526', 'Urban');
insert into research.zip_urban_rural values ('81527', 'Rural');
insert into research.zip_urban_rural values ('81601', 'Urban');
insert into research.zip_urban_rural values ('81610', 'Rural');
insert into research.zip_urban_rural values ('81611', 'Urban');
insert into research.zip_urban_rural values ('81612', 'Rural');
insert into research.zip_urban_rural values ('81615', 'Rural');
insert into research.zip_urban_rural values ('81620', 'Urban');
insert into research.zip_urban_rural values ('81621', 'Urban');
insert into research.zip_urban_rural values ('81623', 'Urban');
insert into research.zip_urban_rural values ('81624', 'Rural');
insert into research.zip_urban_rural values ('81625', 'Urban');
insert into research.zip_urban_rural values ('81630', 'Rural');
insert into research.zip_urban_rural values ('81631', 'Urban');
insert into research.zip_urban_rural values ('81632', 'Urban');
insert into research.zip_urban_rural values ('81633', 'Rural');
insert into research.zip_urban_rural values ('81635', 'Urban');
insert into research.zip_urban_rural values ('81637', 'Urban');
insert into research.zip_urban_rural values ('81638', 'Rural');
insert into research.zip_urban_rural values ('81639', 'Rural');
insert into research.zip_urban_rural values ('81640', 'Rural');
insert into research.zip_urban_rural values ('81641', 'Rural');
insert into research.zip_urban_rural values ('81642', 'Rural');
insert into research.zip_urban_rural values ('81643', 'Rural');
insert into research.zip_urban_rural values ('81645', 'Urban');
insert into research.zip_urban_rural values ('81646', 'Rural');
insert into research.zip_urban_rural values ('81647', 'Urban');
insert into research.zip_urban_rural values ('81648', 'Rural');
insert into research.zip_urban_rural values ('81649', 'Rural');
insert into research.zip_urban_rural values ('81650', 'Urban');
insert into research.zip_urban_rural values ('81652', 'Urban');
insert into research.zip_urban_rural values ('81653', 'Rural');
insert into research.zip_urban_rural values ('81654', 'Rural');
insert into research.zip_urban_rural values ('81655', 'Rural');
insert into research.zip_urban_rural values ('81656', 'Rural');
insert into research.zip_urban_rural values ('81657', 'Urban');
insert into research.zip_urban_rural values ('82063', 'Rural');
select * from research.zip_urban_rural;

select party
	,avg(case when classification = 'Urban' then dist else null end) as urban_dist
	,avg(case when classification = 'Rural' then dist else null end) as rural_dist
	from research.voter_distance a
	join research.zip_urban_rural b on a.vzip5=b.zip5
	group by 1 order by 1
;
select race
	,avg(case when classification = 'Urban' then dist else null end) as urban_dist
	,avg(case when classification = 'Rural' then dist else null end) as rural_dist
	from research.voter_distance a
	join research.zip_urban_rural b on a.vzip5=b.zip5
	group by 1 order by 1
;